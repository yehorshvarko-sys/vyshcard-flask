<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <title>–ö–∞—Ä—Ç–∫–∞ –≤–∏—à–≥–æ—Ä–æ–¥—á–∞–Ω–∏–Ω–∞</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- QR-–∫–æ–¥ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrious/4.0.2/qrious.min.js"></script>

    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        :root {
            --bg-main: radial-gradient(circle at top, #1d4ed8 0, #020617 60%);
            --card-bg: linear-gradient(135deg, #0f172a, #1d4ed8);
            --accent: #38bdf8;
            --accent-soft: rgba(56, 189, 248, 0.18);
            --text-main: #f9fafb;
            --text-muted: #cbd5f5;
            --border-subtle: rgba(148, 163, 184, 0.4);
        }

        body {
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
            background: var(--bg-main);
            color: var(--text-main);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: stretch;
            padding: 12px;
        }

        .app {
            width: 100%;
            max-width: 430px;
            min-height: 620px;
            max-height: 870px;
            border-radius: 28px;
            background: rgba(15, 23, 42, 0.9);
            box-shadow: 0 30px 80px rgba(0,0,0,0.85);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            border: 1px solid rgba(148,163,184,0.4);
            position: relative;
        }

        .app-header {
            padding: 12px 18px 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: radial-gradient(circle at top, rgba(56,189,248,0.25), transparent);
        }

        .app-header-title { font-size: 17px; font-weight: 600; }
        .app-header-subtitle { font-size: 12px; color: var(--text-muted); }

        .app-header-right {
            font-size: 12px;
            color: var(--text-muted);
            text-align: right;
        }

        .chip {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 4px 10px;
            border-radius: 999px;
            background: rgba(15,23,42,0.85);
            border: 1px solid rgba(148,163,184,0.5);
            font-size: 11px;
        }

        .chip-dot {
            width: 7px;
            height: 7px;
            border-radius: 50%;
            background: #22c55e;
        }

        .app-main {
            flex: 1;
            padding: 0 16px 8px;
            overflow-y: auto;
        }

        .screen { display: none; padding: 10px 0 80px; }
        .screen--active { display: block; }

        .vysh-card {
            width: 100%;
            aspect-ratio: 16 / 9;
            padding: 18px 18px 14px;
            border-radius: 22px;
            background: var(--card-bg);
            box-shadow: 0 22px 50px rgba(15,23,42,0.9);
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            position: relative;
            overflow: hidden;
        }

        .vysh-card::after {
            content: "";
            position: absolute;
            width: 280px;
            height: 280px;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(56,189,248,0.28), transparent 60%);
            right: -80px;
            top: -80px;
            opacity: 0.9;
        }

        .vysh-card-top {
            display: flex;
            align-items: center;
            gap: 12px;
            position: relative;
            z-index: 1;
        }

        .coat {
            width: 48px;
            height: 48px;
            border-radius: 14px;
            background: #f9fafb;
            padding: 2px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 10px 20px rgba(15,23,42,0.7);
        }

        .coat img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            display: block;
        }

        .card-title-block { display: flex; flex-direction: column; gap: 2px; }
        .card-title { font-size: 15px; font-weight: 600; }
        .card-subtitle { font-size: 11px; color: var(--text-muted); }

        .vysh-card-middle { margin-top: 12px; position: relative; z-index: 1; }

        .label {
            font-size: 10px;
            text-transform: uppercase;
            letter-spacing: 0.12em;
            color: var(--text-muted);
            margin-bottom: 4px;
        }

        .value { font-size: 19px; font-weight: 600; }
        .value-secondary { font-size: 13px; color: var(--text-muted); margin-top: 2px; }

        .vysh-card-bottom {
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
            position: relative;
            z-index: 1;
        }

        .level-pill {
            display: inline-flex;
            flex-direction: column;
            gap: 2px;
            padding: 6px 10px;
            border-radius: 12px;
            background: rgba(15,23,42,0.8);
            border: 1px solid rgba(148,163,184,0.5);
            font-size: 11px;
        }

        .level-pill span:first-child {
            font-size: 10px;
            text-transform: uppercase;
            letter-spacing: 0.14em;
            color: var(--text-muted);
        }

        .level-pill span:last-child { font-weight: 600; }

        .qr-wrapper {
            background: #f9fafb;
            padding: 4px;
            border-radius: 10px;
            box-shadow: 0 10px 22px rgba(15,23,42,0.85);
        }

        canvas#qr {
            width: 84px !important;
            height: 84px !important;
            display: block;
            border-radius: 8px;
        }

        .section-title {
            font-size: 14px;
            font-weight: 600;
            margin: 18px 2px 6px;
        }

        .section-subtitle {
            font-size: 12px;
            color: var(--text-muted);
            margin: 0 2px 10px;
        }

        .btn {
            border: none;
            outline: none;
            cursor: pointer;
            padding: 9px 12px;
            border-radius: 999px;
            font-size: 13px;
            font-weight: 500;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            background: rgba(56,189,248,0.14);
            color: #e0f2fe;
            border: 1px solid rgba(56,189,248,0.7);
        }

        .btn--secondary {
            background: rgba(15,23,42,0.85);
            border-color: rgba(148,163,184,0.8);
            color: var(--text-muted);
        }

        .btn:active { transform: scale(0.97); }

        .stat-cards {
            margin-top: 8px;
            display: grid;
            grid-template-columns: repeat(2, minmax(0,1fr));
            gap: 8px;
        }

        .stat-card {
            padding: 10px;
            border-radius: 14px;
            background: rgba(15,23,42,0.9);
            border: 1px solid rgba(148,163,184,0.6);
            display: flex;
            flex-direction: column;
            gap: 2px;
            font-size: 12px;
        }

        .stat-label { color: var(--text-muted); }
        .stat-value { font-size: 16px; font-weight: 600; }
        .stat-extra { font-size: 11px; color: var(--text-muted); }

        .partners-list, .history-list {
            margin-top: 8px;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .list-item {
            padding: 10px 12px;
            border-radius: 14px;
            background: rgba(15,23,42,0.85);
            border: 1px solid rgba(148,163,184,0.5);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .list-item-main { display: flex; flex-direction: column; gap: 2px; }
        .list-item-title { font-size: 13px; font-weight: 500; }
        .list-item-sub { font-size: 11px; color: var(--text-muted); }

        .tab-bar {
            position: sticky;
            bottom: 0;
            left: 0;
            right: 0;
            padding: 6px 10px 10px;
            background: radial-gradient(circle at top, rgba(15,23,42,0.95), rgba(15,23,42,0.98));
            border-top: 1px solid rgba(30,64,175,0.7);
            display: flex;
            justify-content: space-between;
            gap: 4px;
        }

        .tab-btn {
            flex: 1;
            border: none;
            background: transparent;
            color: var(--text-muted);
            font-size: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 2px;
            padding: 4px 0;
            border-radius: 999px;
            cursor: pointer;
        }

        .tab-btn-icon { font-size: 18px; }
        .tab-btn--active { background: rgba(37,99,235,0.35); color: #e0f2fe; }

        .auth-overlay {
            position: absolute;
            inset: 0;
            background: rgba(15,23,42,0.95);
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            z-index: 20;
        }

        .auth-card {
            width: 100%;
            max-width: 340px;
            background: rgba(15,23,42,0.97);
            border-radius: 20px;
            border: 1px solid rgba(148,163,184,0.7);
            padding: 18px 16px 16px;
        }

        .auth-title { font-size: 16px; font-weight: 600; margin-bottom: 4px; }
        .auth-sub { font-size: 12px; color: var(--text-muted); margin-bottom: 12px; }

        .input-group { margin: 6px 0; display: flex; flex-direction: column; gap: 4px; }
        .input-label { font-size: 12px; color: var(--text-muted); }
        .input {
            padding: 8px 10px;
            border-radius: 10px;
            border: 1px solid rgba(148,163,184,0.6);
            background: rgba(15,23,42,0.9);
            color: var(--text-main);
            font-size: 13px;
        }
        .input::placeholder { color: rgba(148,163,184,0.8); }
        .input:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 1px rgba(56,189,248,0.4);
        }

        .auth-actions { display: flex; gap: 8px; margin-top: 10px; }
        .auth-error { font-size: 11px; color: #fecaca; margin-top: 6px; min-height: 12px; }

        .text-small { font-size: 11px; color: var(--text-muted); margin-top: 8px; }
    </style>
</head>
<body>
<div class="app">

    <!-- –û–í–ï–†–õ–ï–ô –ê–í–¢–û–†–ò–ó–ê–¶–Ü–á -->
    <div class="auth-overlay" id="auth-overlay">
        <div class="auth-card">
            <div class="auth-title">–í—Ö—ñ–¥ / –†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è</div>
            <div class="auth-sub">–°–ø–µ—Ä—à—É —É–≤—ñ–π–¥–∏ –∞–±–æ —Å—Ç–≤–æ—Ä–∏ –∞–∫–∞—É–Ω—Ç, —â–æ–± –∫–∞—Ä—Ç–∫–∞ –ø—Ä–∞—Ü—é–≤–∞–ª–∞.</div>

            <div class="input-group">
                <label class="input-label" for="auth-username">–õ–æ–≥—ñ–Ω</label>
                <input id="auth-username" class="input" type="text" placeholder="–ù–∞–ø—Ä–∏–∫–ª–∞–¥: yehor">
            </div>
            <div class="input-group">
                <label class="input-label" for="auth-password">–ü–∞—Ä–æ–ª—å</label>
                <input id="auth-password" class="input" type="password" placeholder="–ü–∞—Ä–æ–ª—å">
            </div>

            <div class="auth-actions">
                <button class="btn" id="btn-auth-login">–£–≤—ñ–π—Ç–∏</button>
                <button class="btn btn--secondary" id="btn-auth-register">–ó–∞—Ä–µ—î—Å—Ç—Ä—É–≤–∞—Ç–∏—Å—è</button>
            </div>

            <div class="auth-error" id="auth-error"></div>
            <div class="text-small">
                –ü—ñ—Å–ª—è —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó —Ç–æ–±—ñ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Å—Ç–≤–æ—Ä–∏—Ç—å—Å—è –∫–∞—Ä—Ç–∫–∞ —ñ —Å—Ç–∞—Ä—Ç–æ–≤–∏–π –±–∞–ª–∞–Ω—Å 20 V$.
            </div>
        </div>
    </div>

    <header class="app-header">
        <div>
            <div class="app-header-title">–ö–∞—Ä—Ç–∫–∞ –≤–∏—à–≥–æ—Ä–æ–¥—á–∞–Ω–∏–Ω–∞</div>
            <div class="app-header-subtitle" id="header-subtitle">
                –ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–æ
            </div>
        </div>
        <div class="app-header-right">
            <div class="chip">
                <span class="chip-dot"></span>
                <span id="chip-level">–†—ñ–≤–µ–Ω—å: ‚Äî</span>
            </div>
            <div style="margin-top:2px;font-size:11px;">
                <span id="chip-points">0 V$</span>
            </div>
        </div>
    </header>

    <main class="app-main">
        <!-- –ì–æ–ª–æ–≤–Ω–∞ –∫–∞—Ä—Ç–∫–∞ -->
        <section class="screen screen--active" data-screen="card">
            <div class="vysh-card" id="main-card">
                <div class="vysh-card-top">
                    <div class="coat">
                        <img src="https://upload.wikimedia.org/wikipedia/commons/3/3e/%D0%93%D0%B5%D1%80%D0%B1_%D0%92%D0%B8%D1%88%D0%B3%D0%BE%D1%80%D0%BE%D0%B4%D0%B0.png"
                             alt="–ì–µ—Ä–± –í–∏—à–≥–æ—Ä–æ–¥–∞">
                    </div>
                    <div class="card-title-block">
                        <div class="card-title">–ö–∞—Ä—Ç–∫–∞ –≤–∏—à–≥–æ—Ä–æ–¥—á–∞–Ω–∏–Ω–∞</div>
                        <div class="card-subtitle" id="card-holder">
                            –í–ª–∞—Å–Ω–∏–∫: ‚Äî
                        </div>
                    </div>
                </div>

                <div class="vysh-card-middle">
                    <div class="label">–ù–æ–º–µ—Ä –∫–∞—Ä—Ç–∫–∏</div>
                    <div class="value" id="card-number">VY-0000-0000</div>
                    <div class="value-secondary" id="card-tagline">
                        –ú—ñ—Å—å–∫–∞ —Ü–∏—Ñ—Ä–æ–≤–∞ –∫–∞—Ä—Ç–∫–∞ –º–µ—à–∫–∞–Ω—Ü—è
                    </div>
                </div>

                <div class="vysh-card-bottom">
                    <div class="level-pill">
                        <span>–†—ñ–≤–µ–Ω—å</span>
                        <span id="card-level-text">‚Äî</span>
                    </div>
                    <div class="qr-wrapper">
                        <canvas id="qr"></canvas>
                    </div>
                </div>
            </div>

            <div class="section-title">–®–≤–∏–¥–∫—ñ –¥—ñ—ó</div>
            <div class="section-subtitle">–ö–µ—Ä—É–π —Å–≤–æ—î—é –∫–∞—Ä—Ç–∫–æ—é.</div>

            <div style="display:flex;gap:8px;margin-top:8px;">
                <button class="btn" id="btn-refresh-me">–û–Ω–æ–≤–∏—Ç–∏ –¥–∞–Ω—ñ</button>
                <button class="btn btn--secondary" id="btn-transfer">–ü–µ—Ä–µ–∫–∞–∑–∞—Ç–∏ V$</button>
            </div>

            <div class="section-title">–ó–≤–µ–¥–µ–Ω–Ω—è</div>
            <div class="stat-cards">
                <div class="stat-card">
                    <div class="stat-label">–ë–∞–ª–∞–Ω—Å</div>
                    <div class="stat-value" id="stat-balance">0</div>
                    <div class="stat-extra">V$</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">–ë–∞–ª–∏</div>
                    <div class="stat-value" id="stat-points">0</div>
                    <div class="stat-extra">–¥–ª—è —Ä—ñ–≤–Ω—ñ–≤</div>
                </div>
            </div>
        </section>

        <!-- –ü–∞—Ä—Ç–Ω–µ—Ä–∏ -->
        <section class="screen" data-screen="partners">
            <div class="section-title">–ü–∞—Ä—Ç–Ω–µ—Ä–∏</div>
            <div class="section-subtitle">–ó–Ω–∏–∂–∫–∏ —Ç–∞ –±–æ–Ω—É—Å–∏ –≤—ñ–¥ –ø–∞—Ä—Ç–Ω–µ—Ä—ñ–≤.</div>

            <div id="partners-list" class="partners-list"></div>
        </section>

        <!-- –Ü—Å—Ç–æ—Ä—ñ—è -->
        <section class="screen" data-screen="history">
            <div class="section-title">–Ü—Å—Ç–æ—Ä—ñ—è –æ–ø–µ—Ä–∞—Ü—ñ–π</div>
            <div class="section-subtitle">–û—Å—Ç–∞–Ω–Ω—ñ –ø–µ—Ä–µ–∫–∞–∑–∏ V$.</div>
            <div id="history-list" class="history-list"></div>
        </section>
    </main>

    <!-- –¢–∞–±–±–∞—Ä -->
    <nav class="tab-bar">
        <button class="tab-btn tab-btn--active" data-target="card">
            <span class="tab-btn-icon">üí≥</span>
            <span>–ö–∞—Ä—Ç–∫–∞</span>
        </button>
        <button class="tab-btn" data-target="partners">
            <span class="tab-btn-icon">üè¨</span>
            <span>–ü–∞—Ä—Ç–Ω–µ—Ä–∏</span>
        </button>
        <button class="tab-btn" data-target="history">
            <span class="tab-btn-icon">üìú</span>
            <span>–Ü—Å—Ç–æ—Ä—ñ—è</span>
        </button>
    </nav>
</div>

<script>
    let qrInstance = null;

    async function api(path, options = {}) {
        const res = await fetch(path, {
            credentials: "include",
            headers: {"Content-Type": "application/json"},
            ...options
        });
        const data = await res.json().catch(() => ({}));
        if (!res.ok) {
            throw new Error(data.detail || "–ü–æ–º–∏–ª–∫–∞ –∑–∞–ø–∏—Ç—É");
        }
        return data;
    }

    async function apiRegister(username, password) {
        const body = JSON.stringify({username, password});
        return api("/api/register", {method: "POST", body});
    }

    async function apiLogin(username, password) {
        const body = JSON.stringify({username, password});
        return api("/api/login", {method: "POST", body});
    }

    async function apiMe() {
        return api("/api/me", {method: "GET"});
    }

    async function apiPartners() {
        return api("/api/partners", {method: "GET"});
    }

    async function apiHistory() {
        return api("/api/history", {method: "GET"});
    }

    async function apiTransfer(toUsername, amount) {
        const body = JSON.stringify({to_username: toUsername, amount: amount});
        return api("/api/transfer", {method: "POST", body});
    }

    function renderMainCard(me) {
        const username = me.username;
        const cards = me.cards || [];
        const cardNumber = cards[0] || "VY-0000-0000";

        document.getElementById("header-subtitle").innerText = "–í—ñ—Ç–∞—î–º–æ, " + username;
        document.getElementById("chip-level").innerText = "–†—ñ–≤–µ–Ω—å: " + me.level;
        document.getElementById("chip-points").innerText = me.balance + " " + (me.currency || "V$");

        document.getElementById("card-holder").innerText = "–í–ª–∞—Å–Ω–∏–∫: " + username;
        document.getElementById("card-number").innerText = cardNumber;
        document.getElementById("card-level-text").innerText = me.level;
        document.getElementById("stat-balance").innerText = me.balance;
        document.getElementById("stat-points").innerText = me.points;

        if (!qrInstance) {
            qrInstance = new QRious({
                element: document.getElementById("qr"),
                value: "vyshcard:" + cardNumber,
                size: 256
            });
        } else {
            qrInstance.value = "vyshcard:" + cardNumber;
        }
    }

    function renderPartners(list) {
        const container = document.getElementById("partners-list");
        container.innerHTML = "";
        list.forEach(p => {
            const item = document.createElement("div");
            item.className = "list-item";

            const main = document.createElement("div");
            main.className = "list-item-main";
            const title = document.createElement("div");
            title.className = "list-item-title";
            title.innerText = p.name;
            const sub = document.createElement("div");
            sub.className = "list-item-sub";
            sub.innerText = p.discount + (p.category ? " ‚Ä¢ " + p.category : "");

            main.appendChild(title);
            main.appendChild(sub);

            item.appendChild(main);
            container.appendChild(item);
        });
    }

    function renderHistory(list) {
        const container = document.getElementById("history-list");
        container.innerHTML = "";
        if (!list.length) {
            container.innerHTML = "<div class='list-item'><div class='list-item-main'><div class='list-item-title'>–©–µ –Ω–µ–º–∞—î –æ–ø–µ—Ä–∞—Ü—ñ–π</div></div></div>";
            return;
        }
        list.forEach(tx => {
            const item = document.createElement("div");
            item.className = "list-item";

            const main = document.createElement("div");
            main.className = "list-item-main";
            const title = document.createElement("div");
            title.className = "list-item-title";
            const sign = tx.direction === "outgoing" ? "-" : "+";
            title.innerText = `${sign}${tx.amount} V$ (${tx.direction === "outgoing" ? "–¥–æ" : "–≤—ñ–¥"} ${tx.other_user})`;

            const sub = document.createElement("div");
            sub.className = "list-item-sub";
            sub.innerText = new Date(tx.timestamp).toLocaleString("uk-UA");

            main.appendChild(title);
            main.appendChild(sub);
            item.appendChild(main);
            container.appendChild(item);
        });
    }

    function setupTabs() {
        const tabs = document.querySelectorAll(".tab-btn");
        const screens = document.querySelectorAll(".screen");

        tabs.forEach(tab => {
            tab.addEventListener("click", () => {
                const target = tab.getAttribute("data-target");
                tabs.forEach(t => t.classList.remove("tab-btn--active"));
                tab.classList.add("tab-btn--active");
                screens.forEach(sc => {
                    sc.classList.toggle("screen--active", sc.getAttribute("data-screen") === target);
                });
                if (target === "partners") {
                    apiPartners().then(renderPartners).catch(e => console.warn(e));
                }
                if (target === "history") {
                    apiHistory().then(renderHistory).catch(e => console.warn(e));
                }
            });
        });
    }

    function setupAuth() {
        const overlay = document.getElementById("auth-overlay");
        const errorBox = document.getElementById("auth-error");
        const uInput = document.getElementById("auth-username");
        const pInput = document.getElementById("auth-password");

        document.getElementById("btn-auth-login").addEventListener("click", async () => {
            errorBox.innerText = "";
            const u = uInput.value.trim();
            const p = pInput.value.trim();
            if (!u || !p) {
                errorBox.innerText = "–ó–∞–ø–æ–≤–Ω–∏ –ª–æ–≥—ñ–Ω —ñ –ø–∞—Ä–æ–ª—å";
                return;
            }
            try {
                await apiLogin(u, p);
                const me = await apiMe();
                renderMainCard(me);
                overlay.style.display = "none";
            } catch (e) {
                errorBox.innerText = e.message;
            }
        });

        document.getElementById("btn-auth-register").addEventListener("click", async () => {
            errorBox.innerText = "";
            const u = uInput.value.trim();
            const p = pInput.value.trim();
            if (!u || !p) {
                errorBox.innerText = "–ó–∞–ø–æ–≤–Ω–∏ –ª–æ–≥—ñ–Ω —ñ –ø–∞—Ä–æ–ª—å";
                return;
            }
            try {
                await apiRegister(u, p);
                const me = await apiMe();
                renderMainCard(me);
                overlay.style.display = "none";
            } catch (e) {
                errorBox.innerText = e.message;
            }
        });
    }

    function setupActions() {
        document.getElementById("btn-refresh-me").addEventListener("click", async () => {
            try {
                const me = await apiMe();
                renderMainCard(me);
            } catch (e) {
                alert(e.message);
            }
        });

        document.getElementById("btn-transfer").addEventListener("click", async () => {
            const toUser = prompt("–ö–æ–º—É –ø–µ—Ä–µ–∫–∞–∑–∞—Ç–∏? (–ª–æ–≥—ñ–Ω –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞)");
            if (!toUser) return;
            const amountStr = prompt("–°–∫—ñ–ª—å–∫–∏ V$ –ø–µ—Ä–µ–∫–∞–∑–∞—Ç–∏?");
            if (!amountStr) return;
            const amount = parseFloat(amountStr);
            if (isNaN(amount) || amount <= 0) {
                alert("–ù–µ–∫–æ—Ä–µ–∫—Ç–Ω–∞ —Å—É–º–∞");
                return;
            }
            try {
                const res = await apiTransfer(toUser, amount);
                alert(`–£—Å–ø—ñ—à–Ω–æ! –°–ø–∏—Å–∞–Ω–æ ${res.total_spent} V$ (–∫–æ–º—ñ—Å—ñ—è ${res.commission} V$). –ù–æ–≤–∏–π –±–∞–ª–∞–Ω—Å: ${res.new_balance} V$`);
                const me = await apiMe();
                renderMainCard(me);
            } catch (e) {
                alert(e.message);
            }
        });
    }

    document.addEventListener("DOMContentLoaded", async () => {
        setupTabs();
        setupAuth();
        setupActions();

        // —Å–ø—Ä–æ–±—É—î–º–æ /api/me ‚Äî —è–∫—â–æ —Å–µ—Å—ñ—è –≤–∂–µ —î, –∑–∞–π–¥–µ–º–æ –±–µ–∑ –ª–æ–≥—ñ–Ω—É
        try {
            const me = await apiMe();
            renderMainCard(me);
            document.getElementById("auth-overlay").style.display = "none";
        } catch (e) {
            // –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–æ ‚Äî –ø–æ–∫–∞–∑—É—î–º–æ –æ–≤–µ—Ä–ª–µ–π
        }
    });
</script>
</body>
</html>
